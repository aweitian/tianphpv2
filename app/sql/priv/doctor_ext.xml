<?xml version="1.0" encoding="UTF-8"?>
<doctor_ext>
	<add>
		INSERT INTO `data_doctor_ext` (
			`dod`,`dlv`,`start`,`hot`,`love`,`contribution`,`desc`,`spec`,`duty`
		) VALUES (
			:dod,:dlv,:start,:hot,:love,:contribution,:desc,:spec,CONV(:duty,4,10)
		)
	</add>

	<update>
		UPDATE `data_doctor_ext` SET 
		`dlv`=:dlv,`start`=:start,`hot`=:hot,
		`love`=:love,`contribution`=:contribution,
		`desc`=:desc,`spec`=:spec,`duty`=CONV(:duty,4,10)
		 WHERE `dod`=:dod
	</update>

	<rm>
		DELETE FROM `data_doctor_ext` WHERE `dod`=:dod
	</rm>
	
	<row>
		SELECT 
		  `dod`,
		  `dlv`,
		  `start`,
		  `hot`,
		  `love`,
		  `contribution`,
		  `desc`,
		  `spec`,
		  LPAD(CONV(`data_doctor_ext`.`duty`,10,4),21,'0') as `duty`
		 FROM `data_doctor_ext` WHERE `dod`=:dod
	</row>
	
	<all>
		<cnt>SELECT count(`dod`) as `count` FROM `data_doctor_ext` WHERE 1</cnt>
		<query>
			SELECT 
			`data_doctor`.`name`,
			`data_doctor_lv_meta`.`data` AS lv,
			`data_doctor_ext`.`dod`,
			`data_doctor_ext`.`start`,
			`data_doctor_ext`.`hot`,
			`data_doctor_ext`.`love`,
			`data_doctor_ext`.`contribution`,
			`data_doctor_ext`.`desc`,
			LPAD(CONV(`data_doctor_ext`.`duty`,10,4),21,'0') as `duty`,
			`data_doctor_ext`.`spec`
			
			FROM `data_doctor_ext` 
			LEFT JOIN `data_doctor` ON `data_doctor_ext`.`dod` = `data_doctor`.`sid` 
			LEFT JOIN `data_doctor_lv_meta` ON `data_doctor_ext`.`dlv` = `data_doctor_lv_meta`.`sid`
			
			WHERE 1 LIMIT :offset,:length
		</query>
	</all>

	<!-- 获取没有补充信息的医生 -->
	<noextinfo>
		SELECT `data_doctor`.`sid`,`data_doctor`.`name`
		FROM `data_doctor` WHERE `data_doctor`.`sid` 
		NOT IN (SELECT `data_doctor_ext`.`dod` FROM `data_doctor_ext`)
	</noextinfo>
</doctor_ext>