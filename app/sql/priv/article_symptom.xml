<?xml version="1.0" encoding="UTF-8"?>
<articleSymptom>
	<exists>
		SELECT
		  `aid`,
		  `syd`
		FROM `data_article_sym`
		WHERE `aid` = :aid AND `syd` = :syd
	</exists>
	<all>
		SELECT
		  `aid`,
		  `syd`
		FROM `data_article_sym`
		WHERE `aid` = :aid
	</all>
	<add>
		INSERT INTO `data_article_sym`
	            (`aid`,
	             `syd`)
		VALUES (:aid,
		        :syd);
	</add>
	<rm>
		DELETE
		FROM `data_article_sym`
		WHERE `aid` = :aid
		    AND `syd` = :syd;
	</rm>
	<update>
			UPDATE `data_article_sym` SET 
				`aid`=:aid,`syd`=:new_syd
			 WHERE `aid`=:aid and `syd`=:old_syd
	</update>
	
	<query_on_raw_count>
		SELECT 
			COUNT(`data_article`.`sid`) as `count`
		FROM `data_attr_data`
		LEFT JOIN `data_attr_data` `p_data_attr_data` 
		ON `data_attr_data`.`pid` = `p_data_attr_data`.`sid`
		RIGHT JOIN `data_article_sym`
		ON `data_article_sym`.`syd` =  `data_attr_data`.`sid`    
		LEFT JOIN `data_article`
		ON `data_article`.`sid` = `data_article_sym`.`aid`
	</query_on_raw_count>
	<query_on_raw>
		SELECT 
			`data_article`.`sid` as `aid`,`data_article`.`title` as `title`,
			`data_article`.`date` as `date`,
			`data_attr_data`.`pid` AS `pid`,`p_data_attr_data`.`data` as `pd`,
			`data_attr_data`.`sid` as `mid`,`data_attr_data`.`data` as `md`
		FROM `data_attr_data`
		LEFT JOIN `data_attr_data` `p_data_attr_data` 
		ON `data_attr_data`.`pid` = `p_data_attr_data`.`sid`
		RIGHT JOIN `data_article_sym`
		ON `data_article_sym`.`syd` =  `data_attr_data`.`sid`    
		LEFT JOIN `data_article`
		ON `data_article`.`sid` = `data_article_sym`.`aid`
		@WHERECLAUSE
		ORDER BY `aid` ASC
		LIMIT :offset,:length
	</query_on_raw>
	<where_clause_lv0>
		`data_attr_data`.`pid` = :lv0id
	</where_clause_lv0>
	<where_clause_lv1>
		`data_attr_data`.`sid` = :lv1id
	</where_clause_lv1>
	<where_clause_title>
		`data_article`.`title` like CONCAT('%',:title,'%')
	</where_clause_title>
	
	
	<reldis_homeless>
		<count>
			SELECT COUNT(`data_article`.`sid`) as `count`
			FROM `data_article`
			WHERE
			`data_article`.`sid`
			NOT IN (SELECT `aid` FROM `data_article_sym`)
		</count>
		<query>
			SELECT `data_article`.`sid`,`data_article`.`title`,`data_article`.`date`
			FROM `data_article`
			WHERE
			`data_article`.`sid`
			NOT IN (SELECT `aid` FROM `data_article_sym`)
			LIMIT :offset,:length 
		</query>
	</reldis_homeless>






</articleSymptom>


