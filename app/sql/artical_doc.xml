<?xml version="1.0" encoding="UTF-8"?>
<sql>
	<exists>
		SELECT
		  `aid`,
		  `dod`
		FROM `data_artical_doc`
		WHERE `aid` = :aid AND `dod` = :dod
	</exists>
	<all>
		SELECT
		  `aid`,
		  `dod`
		FROM `data_artical_doc`
		WHERE `aid` = :aid
	</all>
	<add>
		INSERT INTO `data_artical_doc`
	            (`aid`,
	             `dod`)
		VALUES (:aid,
		        :dod);
	</add>
	
	<rm>
		DELETE
		FROM `data_artical_doc`
		WHERE `aid` = :aid
		    AND `dod` = :dod;
	</rm>
	<update>
			UPDATE `data_artical_doc` SET 
				`aid`=:aid,`dod`=:new_dod
			 WHERE `aid`=:aid and `dod`=:old_dod
	</update>
	
	<query_on_raw_count>
		SELECT 
			COUNT(`data_artical`.`sid`) as `count`
		FROM `data_artical_doc`
		LEFT JOIN `data_artical`
			ON `data_artical_doc`.`aid` = `data_artical`.`sid`
		LEFT JOIN `data_doctor`
			ON `data_doctor`.`sid` = `data_artical_doc`.`dod`
		LEFT JOIN `data_doctor_ext`
			ON `data_doctor_ext`.`dod` = `data_artical_doc`.`dod`
		LEFT JOIN `data_doctor_lv_meta`
			ON `data_doctor_lv_meta`.`sid` = `data_doctor_ext`.`dlv`
	</query_on_raw_count>
	<query_on_raw>
		SELECT 
			`data_artical`.`sid` AS `aid`,`data_artical`.`title` AS `title`,
			`data_artical`.`date` AS `date`,
			`data_artical_doc`.`dod`,`data_doctor`.`name` AS `name`,
			`data_doctor_lv_meta`.`data` AS `lv`
		FROM `data_artical_doc`
		LEFT JOIN `data_artical`
			ON `data_artical_doc`.`aid` = `data_artical`.`sid`
		LEFT JOIN `data_doctor`
			ON `data_doctor`.`sid` = `data_artical_doc`.`dod`
		LEFT JOIN `data_doctor_ext`
			ON `data_doctor_ext`.`dod` = `data_artical_doc`.`dod`
		LEFT JOIN `data_doctor_lv_meta`
			ON `data_doctor_lv_meta`.`sid` = `data_doctor_ext`.`dlv`
		@WHERECLAUSE
		ORDER BY `aid` ASC
		LIMIT :offset,:length
	</query_on_raw>
	<where_clause_do>
		`data_artical_doc`.`dod` = :dod
	</where_clause_do>
	<where_clause_title>
		`data_artical`.`title` like CONCAT('%',:title,'%')
	</where_clause_title>
	
	
	<reldoc_homeless>
		<count>
			SELECT COUNT(`data_artical`.`sid`) as `count`
			FROM `data_artical`
			WHERE
			`data_artical`.`sid`
			NOT IN (SELECT `aid` FROM `data_artical_doc`)
		</count>
		<query>
			SELECT `data_artical`.`sid`,`data_artical`.`title`,`data_artical`.`date`
			FROM `data_artical`
			WHERE
			`data_artical`.`sid`
			NOT IN (SELECT `aid` FROM `data_artical_doc`)
			LIMIT :offset,:length 
		</query>
	</reldoc_homeless>	

</sql>